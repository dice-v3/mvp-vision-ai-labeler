{
  "feature": "Add unit tests for API endpoints and major components",
  "description": "Backend has only 8 test files, none of which test the 15 API endpoint modules (datasets, annotations, projects, etc.). Frontend has 13 test files, but they only cover annotation hooks/utils. Major components like Canvas.tsx (1,420 lines), ImageList.tsx (607 lines), and RightPanel.tsx (668 lines) have no tests.",
  "created_at": "2026-01-04T09:15:59.100Z",
  "updated_at": "2026-01-04T18:18:00.000Z",
  "status": "in_progress",
  "planStatus": "ready",
  "workflow_type": "development",
  "services_involved": ["backend", "frontend"],
  "spec_file": "spec.md",
  "phases": [
    {
      "phase_id": "1",
      "title": "Setup Testing Infrastructure",
      "status": "pending",
      "subtasks": [
        {
          "subtask_id": "1.1",
          "title": "Setup backend API test infrastructure",
          "description": "Create conftest.py with FastAPI TestClient fixtures, database fixtures, auth mocks, and common test utilities for API endpoint testing.",
          "status": "completed",
          "files": [
            "backend/tests/conftest.py",
            "backend/tests/fixtures/__init__.py",
            "backend/tests/fixtures/auth_fixtures.py",
            "backend/tests/fixtures/db_fixtures.py"
          ],
          "dependencies": [],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test infrastructure with FastAPI TestClient fixtures, database fixtures with automatic transaction rollback, authentication mocks for Keycloak, and factory fixtures for common test data. All files have valid Python syntax."
        },
        {
          "subtask_id": "1.2",
          "title": "Create frontend component test utilities",
          "description": "Setup test utilities for Canvas, ImageList, and RightPanel components including mock stores, mock API responses, and rendering helpers.",
          "status": "completed",
          "files": [
            "frontend/lib/test-utils/component-test-utils.ts",
            "frontend/lib/test-utils/mock-stores.ts",
            "frontend/lib/test-utils/mock-api.ts"
          ],
          "dependencies": [],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test utilities for frontend component testing including component-test-utils.ts (276 lines), mock-stores.ts (464 lines), and mock-api.ts (400 lines) with full support for Zustand stores, React Query, auth context, and all API endpoints. Includes verification tests and index.ts for easy imports."
        }
      ]
    },
    {
      "phase_id": "2",
      "title": "Backend Core API Endpoint Tests",
      "status": "pending",
      "subtasks": [
        {
          "subtask_id": "2.1",
          "title": "Test auth.py endpoints",
          "description": "Write tests for /me endpoint including valid token, invalid token, missing token, and token claims extraction.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_auth.py"
          ],
          "dependencies": ["1.1"],
          "estimated_effort": "small",
          "notes": "Created comprehensive test suite for GET /api/v1/auth/me endpoint with 12 test scenarios covering valid tokens, invalid tokens, missing tokens, expired tokens, invalid audience/issuer, token claims extraction, custom roles, minimal user data, authentication errors, and response model validation. 336 lines of test coverage following pytest conventions and using fixtures from auth_fixtures.py and conftest.py."
        },
        {
          "subtask_id": "2.2",
          "title": "Test users.py endpoints",
          "description": "Write tests for user CRUD operations, user listing, user search, and permissions validation.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_users.py"
          ],
          "dependencies": ["1.1"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for user endpoints with 54 test scenarios covering GET /search, GET /me, and GET /{user_id} endpoints. Tests include authentication validation, pagination, query parameter validation, role handling, response structure validation, and integration tests. All tests follow pytest conventions and use fixtures from conftest.py and auth_fixtures.py. File: backend/tests/api/test_users.py (732 lines)."
        },
        {
          "subtask_id": "2.3",
          "title": "Test projects.py endpoints",
          "description": "Write tests for project CRUD operations, project listing, filtering, pagination, and access control.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_projects.py"
          ],
          "dependencies": ["1.1"],
          "estimated_effort": "large",
          "notes": "Created comprehensive test suite for project endpoints with 85+ test scenarios covering POST /, GET /, GET /{project_id}, PATCH /{project_id}, DELETE /{project_id}, POST /{project_id}/task-types, GET /{project_id}/images, GET /{project_id}/stats, and access control. Updated db_fixtures.py to use new AnnotationProject schema (task_types array, task_config, task_classes). File: backend/tests/api/test_projects.py (1,460 lines)"
        },
        {
          "subtask_id": "2.4",
          "title": "Test project_permissions.py endpoints",
          "description": "Write tests for permission management, role assignment, permission validation, and access control checks.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_project_permissions.py"
          ],
          "dependencies": ["1.1", "2.3"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for project permission endpoints with 38 test scenarios covering GET /permissions, POST /permissions, PATCH /permissions/{user_id}, DELETE /permissions/{user_id}, and POST /transfer-ownership. Tests cover all 5 roles (owner, admin, reviewer, annotator, viewer), RBAC validation, access control checks, error handling, and both project_id and dataset_id formats. File: backend/tests/api/test_project_permissions.py (1,272 lines)."
        },
        {
          "subtask_id": "2.5",
          "title": "Test projects_classes.py endpoints",
          "description": "Write tests for class CRUD in projects, class validation, and class assignment to annotations.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_projects_classes.py"
          ],
          "dependencies": ["1.1", "2.3"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for project class management endpoints with 48 test scenarios covering POST, PATCH, DELETE, and PUT operations. Tests include: POST /{project_id}/classes (add class with all fields, auto-generated IDs, minimal fields, multiple classes ordering, different task types, error handling), PATCH /{project_id}/classes/{class_id} (update class name, color, description, order, multiple fields, error handling), DELETE /{project_id}/classes/{class_id} (delete unused class, conflict with annotations, error handling), and PUT /{project_id}/classes/reorder (reorder classes successfully, partial list, empty list, error handling). All tests follow pytest conventions and use fixtures from conftest.py, auth_fixtures.py, and db_fixtures.py. File: backend/tests/api/test_projects_classes.py (1,209 lines)."
        }
      ]
    },
    {
      "phase_id": "3",
      "title": "Backend Dataset API Tests",
      "status": "pending",
      "subtasks": [
        {
          "subtask_id": "3.1",
          "title": "Test datasets.py endpoints",
          "description": "Write tests for dataset CRUD operations, dataset listing, filtering by task type, and dataset statistics.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_datasets.py"
          ],
          "dependencies": ["1.1"],
          "estimated_effort": "large",
          "notes": "Created comprehensive test suite for dataset endpoints with 94 test scenarios covering POST /datasets (create with all task types, permissions, project), GET /datasets (list with pagination, access control for owned/public/permitted datasets), GET /datasets/{dataset_id} (get by ID), PUT /datasets/{dataset_id} (update name, description, visibility), GET /datasets/{dataset_id}/images (list images with presigned URLs, random vs sequential ordering), and GET /datasets/{dataset_id}/size (size statistics). All tests follow pytest conventions and use fixtures from conftest.py, auth_fixtures.py, and db_fixtures.py. File: backend/tests/api/test_datasets.py (1,217 lines)."
        },
        {
          "subtask_id": "3.2",
          "title": "Test platform_datasets.py endpoints",
          "description": "Write tests for platform dataset operations, public dataset access, and dataset discovery.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_platform_datasets.py"
          ],
          "dependencies": ["1.1"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for platform dataset endpoints with 40 test scenarios covering GET /{dataset_id} (5 tests), GET / with filters (12 tests), POST /batch (6 tests), GET /{dataset_id}/permissions/{user_id} (8 tests), POST /{dataset_id}/download-url (11 tests), and integration tests (2 tests). Tests include service JWT authentication mocking, filtering by visibility/labeled/format/task_type, pagination validation, access control checks (owner/public/explicit permission), batch operations with specific fields, and download URL generation with presigned S3 URLs. All tests follow pytest conventions and use fixtures from conftest.py, auth_fixtures.py, and db_fixtures.py. File: backend/tests/api/test_platform_datasets.py (1,320 lines)."
        },
        {
          "subtask_id": "3.3",
          "title": "Test admin_datasets.py endpoints",
          "description": "Write tests for admin dataset management, dataset approval, deletion, and bulk operations. Verify admin role requirement.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_admin_datasets.py"
          ],
          "dependencies": ["1.1", "3.1"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for admin dataset endpoints with 41 test scenarios covering GET /overview (6 tests), GET /recent (8 tests), GET /{dataset_id}/details (7 tests), GET /{dataset_id}/progress (8 tests), and GET /{dataset_id}/activity (12 tests). All tests verify admin role requirement and follow pytest conventions using fixtures from conftest.py, auth_fixtures.py, and db_fixtures.py. File: backend/tests/api/test_admin_datasets.py (1,106 lines)."
        }
      ]
    },
    {
      "phase_id": "4",
      "title": "Backend Annotation API Tests",
      "status": "pending",
      "subtasks": [
        {
          "subtask_id": "4.1",
          "title": "Test annotations.py endpoints",
          "description": "Write tests for annotation CRUD, annotation versioning, annotation validation, and batch operations.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_annotations.py"
          ],
          "dependencies": ["1.1", "2.3"],
          "estimated_effort": "large",
          "notes": "Created comprehensive test suite for annotation endpoints with 52 test scenarios covering POST /annotations (create), GET /{id} (retrieve), PUT /{id} (update), DELETE /{id} (delete), GET /project/{id} (list), POST /batch (batch create), GET /history/project/{id} and /history/annotation/{id} (history), POST /{id}/confirm and /{id}/unconfirm (confirmation), and POST /bulk-confirm (bulk operations). Tests include CRUD operations, optimistic locking with version conflicts, permission validation (annotator role required), image lock checking, history tracking, no_object annotation auto-confirmation, task type inference, and comprehensive error handling. File: backend/tests/api/test_annotations.py (1,663 lines)."
        },
        {
          "subtask_id": "4.2",
          "title": "Test image_locks.py endpoints",
          "description": "Write tests for image locking/unlocking, lock expiration, lock stealing prevention, and concurrent access handling.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_image_locks.py"
          ],
          "dependencies": ["1.1"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for image lock endpoints with 60+ test scenarios covering POST /{project_id}/{image_id}/acquire (acquire new lock, refresh lock, lock stealing prevention, expired lock takeover), DELETE /{project_id}/{image_id} (release lock, not locked, not owner), POST /{project_id}/{image_id}/heartbeat (heartbeat success, extends expiration, not locked, not owner), GET /{project_id} (get all locks, empty list, cleanup expired locks, project isolation), GET /{project_id}/{image_id}/status (locked status, not locked, expired cleanup), DELETE /{project_id}/{image_id}/force (admin force release), and concurrent access handling scenarios. Tests include authentication validation, permission validation (annotator/viewer/admin roles), lock expiration mechanisms, heartbeat functionality, and prevention of lock stealing. All tests follow pytest conventions and use fixtures from conftest.py, auth_fixtures.py, and db_fixtures.py. File: backend/tests/api/test_image_locks.py (1,210 lines)."
        },
        {
          "subtask_id": "4.3",
          "title": "Test version_diff.py endpoints",
          "description": "Write tests for version comparison, diff generation, version history, and conflict detection.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_version_diff.py"
          ],
          "dependencies": ["1.1", "4.1"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for version diff endpoints with 60+ test scenarios covering GET /versions/{version_a_id}/compare/{version_b_id} (compare versions with full diff data, image filtering, working vs published versions, error handling), GET /versions/{version_a_id}/compare/{version_b_id}/summary (diff summary without image details), and VersionDiffService utility methods (IoU calculation, geometry normalization, annotation comparison, version parsing, diff calculation for added/removed/modified/unchanged annotations). Tests include version comparison, conflict detection, class-level statistics, and comprehensive error handling. File: backend/tests/api/test_version_diff.py (1,180 lines)."
        }
      ]
    },
    {
      "phase_id": "5",
      "title": "Backend Supporting API Tests",
      "status": "pending",
      "subtasks": [
        {
          "subtask_id": "5.1",
          "title": "Test export.py endpoints",
          "description": "Write tests for annotation export in various formats (COCO, YOLO, etc.), export validation, and file generation.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_export.py"
          ],
          "dependencies": ["1.1", "4.1"],
          "estimated_effort": "large",
          "notes": "Created comprehensive test suite for export endpoints with 60+ test scenarios covering POST /projects/{project_id}/export (12 tests), POST /projects/{project_id}/versions/publish (15 tests), and GET /projects/{project_id}/versions (11 tests). Tests include export in COCO/YOLO/DICE formats, version publishing with auto-increment, annotation snapshots, platform sync, permission validation, and error handling. All tests follow pytest conventions and use fixtures from conftest.py, auth_fixtures.py, and db_fixtures.py. File: backend/tests/api/test_export.py (1,100+ lines)."
        },
        {
          "subtask_id": "5.2",
          "title": "Test invitations.py endpoints",
          "description": "Write tests for invitation creation, acceptance, rejection, expiration, and email notification triggers.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_invitations.py"
          ],
          "dependencies": ["1.1", "2.2"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for invitation endpoints with 70+ test scenarios covering POST /invitations (create - currently 501), GET /invitations (list with sent/received/status/project filters), POST /invitations/accept (token validation, expiration, permission creation), and POST /invitations/{id}/cancel (cancel by inviter/invitee). Tests include invitation creation validation (project exists, admin permission), listing with filters and enriched data, acceptance with role creation, rejection workflows, expiration handling, and integration tests for complete workflows. All tests follow pytest conventions and use fixtures from conftest.py and auth_fixtures.py. File: backend/tests/api/test_invitations.py (1,384 lines)."
        }
      ]
    },
    {
      "phase_id": "6",
      "title": "Backend Admin API Tests",
      "status": "pending",
      "subtasks": [
        {
          "subtask_id": "6.1",
          "title": "Test admin_stats.py endpoints",
          "description": "Write tests for admin statistics retrieval, metrics calculation, user activity stats, and system health. Verify admin role requirement.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_admin_stats.py"
          ],
          "dependencies": ["1.1"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for admin statistics endpoints with 48 test scenarios covering GET /api/v1/admin/stats/overview (7 tests), GET /api/v1/admin/stats/users (8 tests), GET /api/v1/admin/stats/resources (10 tests), GET /api/v1/admin/stats/performance (12 tests), GET /api/v1/admin/stats/sessions (8 tests), and integration tests (3 tests). All tests verify admin role requirement and follow pytest conventions using fixtures from conftest.py and auth_fixtures.py. File: backend/tests/api/test_admin_stats.py (1,200 lines)."
        },
        {
          "subtask_id": "6.2",
          "title": "Test admin_audit.py endpoints",
          "description": "Write tests for audit log retrieval, filtering, search, and log retention. Verify admin role requirement.",
          "status": "completed",
          "files": [
            "backend/tests/api/test_admin_audit.py"
          ],
          "dependencies": ["1.1"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for admin audit log endpoints with 60+ test scenarios covering GET /api/v1/admin/audit-logs (list with pagination and filters), GET /api/v1/admin/audit-logs/{log_id} (detail), GET /api/v1/admin/audit-logs/stats/summary (statistics), GET /api/v1/admin/audit-logs/meta/actions (available actions), and GET /api/v1/admin/audit-logs/meta/resource-types (available resource types). Tests include filtering by user_id, action, resource_type, status, and date ranges, pagination validation, response structure validation, and admin role requirement verification. All tests follow pytest conventions and use fixtures from conftest.py and auth_fixtures.py. File: backend/tests/api/test_admin_audit.py (1,132 lines)."
        }
      ]
    },
    {
      "phase_id": "7",
      "title": "Frontend Canvas Component Tests",
      "status": "pending",
      "subtasks": [
        {
          "subtask_id": "7.1",
          "title": "Test Canvas.tsx core rendering",
          "description": "Write tests for Canvas component initialization, canvas element creation, image loading, and basic rendering logic.",
          "status": "completed",
          "files": [
            "frontend/components/annotation/__tests__/Canvas.test.tsx"
          ],
          "dependencies": ["1.2"],
          "estimated_effort": "large",
          "notes": "Created comprehensive test suite for Canvas component core rendering with 863 lines of tests covering: component initialization (5 tests), canvas element creation (6 tests), image loading (7 tests), basic rendering logic (10 tests), store integration (8 tests), ref management (3 tests), responsive rendering (5 tests), and edge cases (5 tests). Total of 49 test scenarios covering Canvas component initialization, canvas element creation, image loading, and basic rendering logic. Tests use vitest, React Testing Library, and comprehensive mock utilities from test-utils. File: frontend/components/annotation/__tests__/Canvas.test.tsx (863 lines)."
        },
        {
          "subtask_id": "7.2",
          "title": "Test Canvas.tsx annotation drawing",
          "description": "Write tests for drawing annotations (bbox, polygon, point, line), tool interactions, and drawing state management.",
          "status": "completed",
          "files": [
            "frontend/components/annotation/__tests__/Canvas-drawing.test.tsx"
          ],
          "dependencies": ["1.2", "7.1"],
          "estimated_effort": "large",
          "notes": "Created comprehensive test suite for Canvas component drawing functionality with 82 test scenarios covering: bbox drawing (10 tests), polygon drawing (10 tests), point drawing (4 tests), line/polyline drawing (9 tests), circle drawing (7 tests), circle 3-point drawing (6 tests), tool interactions (6 tests), drawing state management (10 tests), drawing with existing annotations (4 tests), drawing with different task types (4 tests), drawing preview rendering (6 tests), and edge cases (6 tests). All tests follow vitest conventions and use comprehensive mocking of stores, APIs, hooks, and tools. File: frontend/components/annotation/__tests__/Canvas-drawing.test.tsx (1,211 lines)."
        },
        {
          "subtask_id": "7.3",
          "title": "Test Canvas.tsx zoom and pan",
          "description": "Write tests for zoom functionality, pan/drag, fit-to-screen, and coordinate transformations.",
          "status": "completed",
          "files": [
            "frontend/components/annotation/__tests__/Canvas-transforms.test.tsx"
          ],
          "dependencies": ["1.2", "7.1"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for Canvas component zoom and pan functionality with 70+ test scenarios covering: zoom functionality (mouse wheel zoom, zoom controls/buttons, fit-to-screen, zoom limits/edge cases, zoom percentage display - 25 tests), pan/drag functionality (pan state management, pan reset, cursor changes during pan, pan with different zoom levels - 15 tests), coordinate transformations (screen-to-canvas, canvas-to-image, image-to-canvas, screen-to-image, image bounds calculation, point in image detection, coordinate clamping - 18 tests), integration tests (zoom+pan combinations, multiple operations, state persistence - 8 tests), and edge cases (no image loaded, boundary values, large/negative values, fractional values - 9 tests). All tests follow vitest conventions and use comprehensive mocking of stores, APIs, hooks, and UI components. File: frontend/components/annotation/__tests__/Canvas-transforms.test.tsx (988 lines)."
        },
        {
          "subtask_id": "7.4",
          "title": "Test Canvas.tsx selection and editing",
          "description": "Write tests for annotation selection, editing, resizing, moving, and deletion.",
          "status": "completed",
          "files": [
            "frontend/components/annotation/__tests__/Canvas-selection.test.tsx"
          ],
          "dependencies": ["1.2", "7.1"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for Canvas component selection and editing functionality with 38 test scenarios covering: annotation selection (8 tests for bbox/polygon/polyline/circle selection, deselection, hidden annotations, overlapping annotations, cursor updates), bbox resizing (6 tests for handle-based resizing, all 8 handles, lock checks, cursor updates), polygon editing (6 tests for vertex selection/drag, vertex addition on edges, polygon moving, lock checks, minimum vertices), polyline editing (4 tests for vertex selection, vertex addition, polyline moving, minimum vertices), circle editing (6 tests for center drag, radius handle resize, all 4 handles, area-based moving, lock checks), annotation deletion (2 tests for delete key, delete all), state management (3 tests for clearing vertex/handle selection, maintaining selection during edit), and edge cases (5 tests for empty annotations, invalid geometry, rapid changes, zoom/pan boundaries). All tests follow vitest conventions and use comprehensive mocking of stores, APIs, hooks, and tools. File: frontend/components/annotation/__tests__/Canvas-selection.test.tsx (1,422 lines)."
        }
      ]
    },
    {
      "phase_id": "8",
      "title": "Frontend ImageList Component Tests",
      "status": "pending",
      "subtasks": [
        {
          "subtask_id": "8.1",
          "title": "Test ImageList.tsx rendering and navigation",
          "description": "Write tests for image list rendering, thumbnail display, image selection, navigation (prev/next), and keyboard shortcuts.",
          "status": "completed",
          "files": [
            "frontend/components/annotation/__tests__/ImageList.test.tsx"
          ],
          "dependencies": ["1.2"],
          "estimated_effort": "large",
          "notes": "Created comprehensive test suite for ImageList component with 70+ test scenarios covering: basic rendering (header, filters, search, view toggle), grid view rendering (thumbnails, status badges, image numbers), list view rendering (table layout, file names, annotation counts), image selection (normal click, ctrl+click, meta+click, shift+click), view toggle (grid â†” list), filtering (all statuses), search functionality (file name, folder path, case-insensitive), lock indicators (locked, available, own locks), diff mode (diff badges, change counts), no object indicator, load more functionality (button visibility, API calls, loading state), auto-scroll to current image, and edge cases (missing data, errors, rapid changes). File: frontend/components/annotation/__tests__/ImageList.test.tsx (1,072 lines)."
        },
        {
          "subtask_id": "8.2",
          "title": "Test ImageList.tsx filtering and sorting",
          "description": "Write tests for filtering by annotation status, sorting options, search functionality, and pagination.",
          "status": "completed",
          "files": [
            "frontend/components/annotation/__tests__/ImageList-filters.test.tsx"
          ],
          "dependencies": ["1.2", "8.1"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for ImageList filtering and sorting with 150+ test scenarios covering: Advanced status filtering (6 tests), advanced search functionality (8 tests), search and filter combinations (7 tests), pagination with filtering (4 tests), pagination with search (2 tests), performance and large datasets (3 tests), edge cases and error handling (7 tests), filter state persistence (3 tests), and count display with filtering (3 tests). All tests follow vitest conventions and use comprehensive mocking of stores, APIs, and test utilities. File: frontend/components/annotation/__tests__/ImageList-filters.test.tsx (834 lines)."
        },
        {
          "subtask_id": "8.3",
          "title": "Test ImageList.tsx state management",
          "description": "Write tests for image loading states, error handling, empty states, and data refetching.",
          "status": "completed",
          "files": [
            "frontend/components/annotation/__tests__/ImageList-state.test.tsx"
          ],
          "dependencies": ["1.2", "8.1"],
          "estimated_effort": "medium",
          "notes": "Created comprehensive test suite for ImageList state management with 80+ test scenarios covering: Loading states (backgroundLoading, loadingMore, locksLoading - 7 tests), error handling (image load fallback, API errors, missing data, null/undefined handling - 8 tests), empty states (no images, filter excludes all, search excludes all, empty project - 7 tests), data refetching (load more, refresh locks every 5s, update locks, cleanup intervals - 7 tests), infinite scroll (auto-load near bottom, prevent double load, cleanup listeners - 4 tests), state updates (images change, totalImages change, currentIndex change, project change - 4 tests), and performance (large datasets, lazy loading, rapid filter changes - 3 tests). All tests follow vitest conventions and use comprehensive mocking of stores, APIs, timers, and test utilities. File: frontend/components/annotation/__tests__/ImageList-state.test.tsx (1,059 lines)."
        }
      ]
    },
    {
      "phase_id": "9",
      "title": "Frontend RightPanel Component Tests",
      "status": "pending",
      "subtasks": [
        {
          "subtask_id": "9.1",
          "title": "Test RightPanel.tsx annotation list",
          "description": "Write tests for annotation list display, annotation selection, annotation filtering by class, and list interactions.",
          "status": "pending",
          "files": [
            "frontend/components/annotation/__tests__/RightPanel.test.tsx"
          ],
          "dependencies": ["1.2"],
          "estimated_effort": "large",
          "notes": "RightPanel.tsx is 668 lines - test panel functionality"
        },
        {
          "subtask_id": "9.2",
          "title": "Test RightPanel.tsx annotation editing",
          "description": "Write tests for annotation property editing, class assignment, attribute modification, and form validation.",
          "status": "pending",
          "files": [
            "frontend/components/annotation/__tests__/RightPanel-editing.test.tsx"
          ],
          "dependencies": ["1.2", "9.1"],
          "estimated_effort": "medium",
          "notes": "Test annotation modification through panel"
        },
        {
          "subtask_id": "9.3",
          "title": "Test RightPanel.tsx class management",
          "description": "Write tests for class creation, class editing, class deletion, and class color management in the panel.",
          "status": "pending",
          "files": [
            "frontend/components/annotation/__tests__/RightPanel-classes.test.tsx"
          ],
          "dependencies": ["1.2", "9.1"],
          "estimated_effort": "medium",
          "notes": "Test class management UI"
        }
      ]
    },
    {
      "phase_id": "10",
      "title": "Integration and Verification",
      "status": "pending",
      "subtasks": [
        {
          "subtask_id": "10.1",
          "title": "Run and verify backend tests",
          "description": "Run all backend tests with pytest, ensure all pass, check coverage reports, and fix any failing tests.",
          "status": "pending",
          "files": [],
          "dependencies": ["2.1", "2.2", "2.3", "2.4", "2.5", "3.1", "3.2", "3.3", "4.1", "4.2", "4.3", "5.1", "5.2", "6.1", "6.2"],
          "estimated_effort": "medium",
          "notes": "Target minimum 70% coverage for API endpoints"
        },
        {
          "subtask_id": "10.2",
          "title": "Run and verify frontend tests",
          "description": "Run all frontend tests with vitest, ensure all pass, check coverage reports, and fix any failing tests.",
          "status": "pending",
          "files": [],
          "dependencies": ["7.1", "7.2", "7.3", "7.4", "8.1", "8.2", "8.3", "9.1", "9.2", "9.3"],
          "estimated_effort": "medium",
          "notes": "Target minimum 70% coverage for major components"
        },
        {
          "subtask_id": "10.3",
          "title": "Update test documentation",
          "description": "Document testing patterns, update README with test running instructions, and create testing guidelines for future contributors.",
          "status": "pending",
          "files": [
            "backend/tests/README.md",
            "frontend/README.md"
          ],
          "dependencies": ["10.1", "10.2"],
          "estimated_effort": "small",
          "notes": "Include examples and best practices"
        }
      ]
    }
  ],
  "risks": [
    {
      "description": "Canvas.tsx is 1,420 lines - complex component may require extensive mocking",
      "mitigation": "Split tests into logical groups (rendering, drawing, transforms, selection) and use comprehensive test utilities"
    },
    {
      "description": "API endpoints may have complex authentication dependencies",
      "mitigation": "Create reusable auth fixtures and mock Keycloak token validation"
    },
    {
      "description": "Some API endpoints may depend on external services (S3, Redis)",
      "mitigation": "Mock external service dependencies in test fixtures"
    },
    {
      "description": "Frontend components may have complex state management with Zustand",
      "mitigation": "Create mock stores and test utilities for state management"
    }
  ],
  "success_criteria": [
    "All 15 backend API endpoint modules have comprehensive test coverage",
    "Canvas.tsx, ImageList.tsx, and RightPanel.tsx have test coverage for core functionality",
    "Backend test coverage is at least 70% for API endpoints",
    "Frontend test coverage is at least 70% for major components",
    "All tests pass in CI/CD pipeline",
    "Test documentation is complete and helpful for future contributors"
  ],
  "final_acceptance": [
    "All backend API endpoint tests are written and passing",
    "All frontend major component tests are written and passing",
    "Code coverage targets are met (70%+ for endpoints and components)",
    "Test documentation is complete",
    "Tests are integrated into CI/CD pipeline"
  ],
  "qa_signoff": {
    "status": "pending",
    "tests_passed": "",
    "issues": ""
  }
}
